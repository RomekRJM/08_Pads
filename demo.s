;
; File generated by cc65 v 2.19 - Git 6ea1f8e
;
	.fopt		compiler,"cc65 v 2.19 - Git 6ea1f8e"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	on
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.dbg		file, "demo.c", 5705, 1652467546
	.dbg		file, "lib/neslib.h", 9271, 1652462929
	.dbg		file, "lib/nesdoug.h", 6862, 1652462929
	.dbg		file, "sprites.h", 616, 1652463063
	.dbg		file, "lungs.h", 744, 1652462929
	.dbg		file, "math.h", 206, 1652466549
	.forceimport	__STARTUP__
	.dbg		sym, "pal_bg", "00", extern, "_pal_bg"
	.dbg		sym, "pal_spr", "00", extern, "_pal_spr"
	.dbg		sym, "ppu_wait_nmi", "00", extern, "_ppu_wait_nmi"
	.dbg		sym, "ppu_off", "00", extern, "_ppu_off"
	.dbg		sym, "ppu_on_all", "00", extern, "_ppu_on_all"
	.dbg		sym, "oam_clear", "00", extern, "_oam_clear"
	.dbg		sym, "oam_meta_spr", "00", extern, "_oam_meta_spr"
	.dbg		sym, "bank_spr", "00", extern, "_bank_spr"
	.dbg		sym, "vram_adr", "00", extern, "_vram_adr"
	.dbg		sym, "vram_unrle", "00", extern, "_vram_unrle"
	.dbg		sym, "get_frame_count", "00", extern, "_get_frame_count"
	.dbg		sym, "virusPath", "00", extern, "_virusPath"
	.import		_pal_bg
	.import		_pal_spr
	.import		_ppu_wait_nmi
	.import		_ppu_off
	.import		_ppu_on_all
	.import		_oam_clear
	.import		_oam_meta_spr
	.import		_bank_spr
	.import		_vram_adr
	.import		_vram_unrle
	.import		_get_frame_count
	.export		_virusSprite0
	.export		_virusSprite1
	.export		_virusSprite2
	.export		_virusSprite3
	.export		_lungs
	.import		_virusPath
	.export		_virusCoordinates
	.export		_initialVirusCoordinates
	.export		_i
	.export		_dbg1
	.export		_dbg2
	.export		_dbg3
	.export		_paletteBackground
	.export		_paletteSprite
	.export		_initialise_viruses
	.export		_movement
	.export		_draw_sprites
	.export		_init_nes
	.export		_main

.segment	"DATA"

_dbg1:
	.word	$0080
_dbg2:
	.word	$0081
_dbg3:
	.word	$0082

.segment	"RODATA"

_virusSprite0:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$10
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$11
	.byte	$00
	.byte	$80
_virusSprite1:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$10
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$11
	.byte	$00
	.byte	$80
_virusSprite2:
	.byte	$00
	.byte	$00
	.byte	$20
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$21
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$30
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$31
	.byte	$00
	.byte	$80
_virusSprite3:
	.byte	$00
	.byte	$00
	.byte	$40
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$41
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$50
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$51
	.byte	$00
	.byte	$80
_lungs:
	.byte	$01
	.byte	$00
	.byte	$01
	.byte	$FE
	.byte	$00
	.byte	$01
	.byte	$4C
	.byte	$80
	.byte	$81
	.byte	$82
	.byte	$83
	.byte	$84
	.byte	$85
	.byte	$86
	.byte	$87
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$90
	.byte	$91
	.byte	$92
	.byte	$93
	.byte	$94
	.byte	$95
	.byte	$96
	.byte	$97
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$A0
	.byte	$A1
	.byte	$A2
	.byte	$A3
	.byte	$A4
	.byte	$A5
	.byte	$A6
	.byte	$A7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$B0
	.byte	$B1
	.byte	$B2
	.byte	$B3
	.byte	$B4
	.byte	$B5
	.byte	$B6
	.byte	$B7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$C0
	.byte	$C1
	.byte	$C2
	.byte	$C3
	.byte	$C4
	.byte	$C5
	.byte	$C6
	.byte	$C7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$D0
	.byte	$D1
	.byte	$D2
	.byte	$D3
	.byte	$D4
	.byte	$D5
	.byte	$D6
	.byte	$D7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$E0
	.byte	$E1
	.byte	$E2
	.byte	$E3
	.byte	$E4
	.byte	$E5
	.byte	$E6
	.byte	$E7
	.byte	$00
	.byte	$01
	.byte	$FE
	.byte	$00
	.byte	$01
	.byte	$BD
	.byte	$A0
	.byte	$01
	.byte	$03
	.byte	$20
	.byte	$00
	.byte	$01
	.byte	$04
	.byte	$AA
	.byte	$AA
	.byte	$00
	.byte	$01
	.byte	$05
	.byte	$0A
	.byte	$0A
	.byte	$00
	.byte	$01
	.byte	$19
	.byte	$00
	.byte	$01
	.byte	$00
_paletteBackground:
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
_paletteSprite:
	.byte	$0F
	.byte	$3D
	.byte	$05
	.byte	$17
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05

.segment	"BSS"

.segment	"ZEROPAGE"
_virusCoordinates:
	.res	32,$00
_initialVirusCoordinates:
	.res	32,$00
_i:
	.res	1,$00

; ---------------------------------------------------------------
; void __near__ initialise_viruses (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_initialise_viruses: near

	.dbg	func, "initialise_viruses", "00", extern, "_initialise_viruses"
	.dbg	sym, "i", "00", auto, -2
	.dbg	sym, "virusesInRow", "00", auto, -4
	.dbg	sym, "y", "00", auto, -6
	.dbg	sym, "x", "00", auto, -8

.segment	"CODE"

;
; int virusesInRow = 0;
;
	.dbg	line, "demo.c", 39
	jsr     decsp2
	ldx     #$00
	lda     #$00
	jsr     pushax
;
; int y = 120;
;
	.dbg	line, "demo.c", 40
	ldx     #$00
	lda     #$78
	jsr     pushax
;
; int x = 54;
;
	.dbg	line, "demo.c", 41
	ldx     #$00
	lda     #$36
	jsr     pushax
;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 43
	ldx     #$00
	lda     #$00
	ldy     #$06
	jsr     staxysp
L0002:	ldy     #$07
	jsr     ldaxysp
	cmp     #$10
	txa
	sbc     #$00
	bvc     L0006
	eor     #$80
L0006:	asl     a
	lda     #$00
	ldx     #$00
	rol     a
	jne     L0005
	jmp     L0003
;
; initialVirusCoordinates[i].x = x;
;
	.dbg	line, "demo.c", 44
L0005:	ldy     #$07
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_initialVirusCoordinates)
	tay
	txa
	adc     #>(_initialVirusCoordinates)
	tax
	tya
	jsr     pushax
	ldy     #$02
	ldx     #$00
	lda     (sp),y
	ldy     #$00
	jsr     staspidx
;
; initialVirusCoordinates[i].y = y;
;
	.dbg	line, "demo.c", 45
	ldy     #$07
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_initialVirusCoordinates)
	tay
	txa
	adc     #>(_initialVirusCoordinates)
	tax
	tya
	jsr     pushax
	ldy     #$04
	ldx     #$00
	lda     (sp),y
	ldy     #$01
	jsr     staspidx
;
; if (virusesInRow < 3) {
;
	.dbg	line, "demo.c", 47
	ldy     #$05
	jsr     ldaxysp
	cmp     #$03
	txa
	sbc     #$00
	bvc     L0008
	eor     #$80
L0008:	asl     a
	lda     #$00
	ldx     #$00
	rol     a
	jeq     L0007
;
; x += 40;
;
	.dbg	line, "demo.c", 48
	ldy     #$00
	ldx     #$00
	lda     #$28
	jsr     addeqysp
;
; ++virusesInRow;
;
	.dbg	line, "demo.c", 49
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
;
; } else {
;
	.dbg	line, "demo.c", 50
	jmp     L0004
;
; x = 54;
;
	.dbg	line, "demo.c", 51
L0007:	ldx     #$00
	lda     #$36
	ldy     #$00
	jsr     staxysp
;
; y += 20;
;
	.dbg	line, "demo.c", 52
	ldy     #$02
	ldx     #$00
	lda     #$14
	jsr     addeqysp
;
; virusesInRow = 0;
;
	.dbg	line, "demo.c", 53
	ldx     #$00
	lda     #$00
	ldy     #$04
	jsr     staxysp
;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 43
L0004:	ldy     #$06
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     L0002
;
; }
;
	.dbg	line, "demo.c", 56
L0003:	jsr     incsp8
	rts

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ movement (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_movement: near

	.dbg	func, "movement", "00", extern, "_movement"

.segment	"CODE"

;
; virusCoordinates[0].x = initialVirusCoordinates[0].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 59
	ldx     #$00
	lda     _initialVirusCoordinates
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates
;
; virusCoordinates[0].y = initialVirusCoordinates[0].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 60
	ldx     #$00
	lda     _initialVirusCoordinates+1
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+1
;
; virusCoordinates[1].x = initialVirusCoordinates[1].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 61
	ldx     #$00
	lda     _initialVirusCoordinates+2
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+2
;
; virusCoordinates[1].y = initialVirusCoordinates[1].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 62
	ldx     #$00
	lda     _initialVirusCoordinates+3
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+3
;
; virusCoordinates[2].x = initialVirusCoordinates[2].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 63
	ldx     #$00
	lda     _initialVirusCoordinates+4
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+4
;
; virusCoordinates[2].y = initialVirusCoordinates[2].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 64
	ldx     #$00
	lda     _initialVirusCoordinates+5
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+5
;
; virusCoordinates[3].x = initialVirusCoordinates[3].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 65
	ldx     #$00
	lda     _initialVirusCoordinates+6
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+6
;
; virusCoordinates[3].y = initialVirusCoordinates[3].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 66
	ldx     #$00
	lda     _initialVirusCoordinates+7
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+7
;
; virusCoordinates[4].x = initialVirusCoordinates[4].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 67
	ldx     #$00
	lda     _initialVirusCoordinates+8
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+8
;
; virusCoordinates[4].y = initialVirusCoordinates[4].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 68
	ldx     #$00
	lda     _initialVirusCoordinates+9
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+9
;
; virusCoordinates[5].x = initialVirusCoordinates[5].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 69
	ldx     #$00
	lda     _initialVirusCoordinates+10
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+10
;
; virusCoordinates[5].y = initialVirusCoordinates[5].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 70
	ldx     #$00
	lda     _initialVirusCoordinates+11
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+11
;
; virusCoordinates[6].x = initialVirusCoordinates[6].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 71
	ldx     #$00
	lda     _initialVirusCoordinates+12
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+12
;
; virusCoordinates[6].y = initialVirusCoordinates[6].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 72
	ldx     #$00
	lda     _initialVirusCoordinates+13
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+13
;
; virusCoordinates[7].x = initialVirusCoordinates[7].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 73
	ldx     #$00
	lda     _initialVirusCoordinates+14
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+14
;
; virusCoordinates[7].y = initialVirusCoordinates[7].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 74
	ldx     #$00
	lda     _initialVirusCoordinates+15
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+15
;
; virusCoordinates[8].x = initialVirusCoordinates[8].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 75
	ldx     #$00
	lda     _initialVirusCoordinates+16
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+16
;
; virusCoordinates[8].y = initialVirusCoordinates[8].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 76
	ldx     #$00
	lda     _initialVirusCoordinates+17
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+17
;
; virusCoordinates[9].x = initialVirusCoordinates[9].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 77
	ldx     #$00
	lda     _initialVirusCoordinates+18
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+18
;
; virusCoordinates[9].y = initialVirusCoordinates[9].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 78
	ldx     #$00
	lda     _initialVirusCoordinates+19
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+19
;
; virusCoordinates[10].x = initialVirusCoordinates[10].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 79
	ldx     #$00
	lda     _initialVirusCoordinates+20
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+20
;
; virusCoordinates[10].y = initialVirusCoordinates[10].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 80
	ldx     #$00
	lda     _initialVirusCoordinates+21
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+21
;
; virusCoordinates[11].x = initialVirusCoordinates[11].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 81
	ldx     #$00
	lda     _initialVirusCoordinates+22
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+22
;
; virusCoordinates[11].y = initialVirusCoordinates[11].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 82
	ldx     #$00
	lda     _initialVirusCoordinates+23
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+23
;
; virusCoordinates[12].x = initialVirusCoordinates[12].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 83
	ldx     #$00
	lda     _initialVirusCoordinates+24
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+24
;
; virusCoordinates[12].y = initialVirusCoordinates[12].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 84
	ldx     #$00
	lda     _initialVirusCoordinates+25
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+25
;
; virusCoordinates[13].x = initialVirusCoordinates[13].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 85
	ldx     #$00
	lda     _initialVirusCoordinates+26
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+26
;
; virusCoordinates[13].y = initialVirusCoordinates[13].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 86
	ldx     #$00
	lda     _initialVirusCoordinates+27
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+27
;
; virusCoordinates[14].x = initialVirusCoordinates[14].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 87
	ldx     #$00
	lda     _initialVirusCoordinates+28
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+28
;
; virusCoordinates[14].y = initialVirusCoordinates[14].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 88
	ldx     #$00
	lda     _initialVirusCoordinates+29
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+29
;
; virusCoordinates[15].x = initialVirusCoordinates[15].x + virusPath[get_frame_count()].x;
;
	.dbg	line, "demo.c", 89
	ldx     #$00
	lda     _initialVirusCoordinates+30
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+30
;
; virusCoordinates[15].y = initialVirusCoordinates[15].y + virusPath[get_frame_count()].y;
;
	.dbg	line, "demo.c", 90
	ldx     #$00
	lda     _initialVirusCoordinates+31
	jsr     pushax
	jsr     _get_frame_count
	jsr     aslax1
	clc
	adc     #<(_virusPath)
	tay
	txa
	adc     #>(_virusPath)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     tosaddax
	ldx     #$00
	sta     _virusCoordinates+31
;
; }
;
	.dbg	line, "demo.c", 91
	rts

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ draw_sprites (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_sprites: near

	.dbg	func, "draw_sprites", "00", extern, "_draw_sprites"
	.dbg	sym, "i", "00", auto, -2

.segment	"CODE"

;
; oam_clear();
;
	.dbg	line, "demo.c", 96
	jsr     decsp2
	jsr     _oam_clear
;
; if (get_frame_count() % 8 == 0) {
;
	.dbg	line, "demo.c", 98
	jsr     _get_frame_count
	ldx     #$00
	and     #$07
	cpx     #$00
	bne     L0003
	cmp     #$00
L0003:	jsr     booleq
	jeq     L0002
;
; virusSprite = ++virusSprite % 4;
;
	.dbg	line, "demo.c", 99
	inc     M0001
	bne     L0004
	inc     M0001+1
L0004:	lda     M0001
	ldx     M0001+1
	jsr     pushax
	ldx     #$00
	lda     #$04
	jsr     tosmodax
	sta     M0001
	stx     M0001+1
;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 102
L0002:	ldx     #$00
	lda     #$00
	ldy     #$00
	jsr     staxysp
L0005:	ldy     #$01
	jsr     ldaxysp
	cmp     #$10
	txa
	sbc     #$00
	bvc     L0009
	eor     #$80
L0009:	asl     a
	lda     #$00
	ldx     #$00
	rol     a
	jne     L0008
	jmp     L0006
;
; switch (virusSprite) {
;
	.dbg	line, "demo.c", 103
L0008:	lda     M0001
	ldx     M0001+1
	jmp     L000A
;
; }
;
	.dbg	line, "demo.c", 116
L000A:	cpx     #$00
	jne     L0007
	cmp     #$00
	jeq     L000C
	cmp     #$01
	jeq     L000D
	cmp     #$02
	jeq     L000E
	cmp     #$03
	jeq     L000F
	jmp     L0007
	jmp     L0007
;
; oam_meta_spr(virusCoordinates[i].x, virusCoordinates[i].y, virusSprite0);
;
	.dbg	line, "demo.c", 105
L000C:	ldy     #$01
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     pusha
	ldy     #$02
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     pusha
	lda     #<(_virusSprite0)
	ldx     #>(_virusSprite0)
	jsr     _oam_meta_spr
;
; break;
;
	.dbg	line, "demo.c", 106
	jmp     L0007
;
; oam_meta_spr(virusCoordinates[i].x, virusCoordinates[i].y, virusSprite1);
;
	.dbg	line, "demo.c", 108
L000D:	ldy     #$01
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     pusha
	ldy     #$02
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     pusha
	lda     #<(_virusSprite1)
	ldx     #>(_virusSprite1)
	jsr     _oam_meta_spr
;
; break;
;
	.dbg	line, "demo.c", 109
	jmp     L0007
;
; oam_meta_spr(virusCoordinates[i].x, virusCoordinates[i].y, virusSprite2);
;
	.dbg	line, "demo.c", 111
L000E:	ldy     #$01
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     pusha
	ldy     #$02
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     pusha
	lda     #<(_virusSprite2)
	ldx     #>(_virusSprite2)
	jsr     _oam_meta_spr
;
; break;
;
	.dbg	line, "demo.c", 112
	jmp     L0007
;
; oam_meta_spr(virusCoordinates[i].x, virusCoordinates[i].y, virusSprite3);
;
	.dbg	line, "demo.c", 114
L000F:	ldy     #$01
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$00
	jsr     ldauidx
	jsr     pusha
	ldy     #$02
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_virusCoordinates)
	tay
	txa
	adc     #>(_virusCoordinates)
	tax
	tya
	ldy     #$01
	jsr     ldauidx
	jsr     pusha
	lda     #<(_virusSprite3)
	ldx     #>(_virusSprite3)
	jsr     _oam_meta_spr
;
; break;
;
	.dbg	line, "demo.c", 115
	jmp     L0007
;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 102
L0007:	ldy     #$00
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     L0005
;
; }
;
	.dbg	line, "demo.c", 118
L0006:	jsr     incsp2
	rts

	.dbg	line
.segment	"DATA"

M0001:
	.word	$0000

.endproc

; ---------------------------------------------------------------
; void __near__ init_nes (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_init_nes: near

	.dbg	func, "init_nes", "00", extern, "_init_nes"

.segment	"CODE"

;
; ppu_off(); // screen off
;
	.dbg	line, "demo.c", 121
	jsr     _ppu_off
;
; pal_bg(paletteBackground);
;
	.dbg	line, "demo.c", 124
	lda     #<(_paletteBackground)
	ldx     #>(_paletteBackground)
	jsr     _pal_bg
;
; pal_spr(paletteSprite);
;
	.dbg	line, "demo.c", 125
	lda     #<(_paletteSprite)
	ldx     #>(_paletteSprite)
	jsr     _pal_spr
;
; bank_spr(1);
;
	.dbg	line, "demo.c", 129
	ldx     #$00
	lda     #$01
	jsr     _bank_spr
;
; vram_adr(NAMETABLE_A);
;
	.dbg	line, "demo.c", 131
	ldx     #$20
	lda     #$00
	jsr     _vram_adr
;
; vram_unrle(lungs);
;
	.dbg	line, "demo.c", 133
	lda     #<(_lungs)
	ldx     #>(_lungs)
	jsr     _vram_unrle
;
; ppu_on_all();
;
	.dbg	line, "demo.c", 136
	jsr     _ppu_on_all
;
; }
;
	.dbg	line, "demo.c", 137
	rts

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ main (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_main: near

	.dbg	func, "main", "00", extern, "_main"

.segment	"CODE"

;
; init_nes();
;
	.dbg	line, "demo.c", 141
	jsr     _init_nes
;
; initialise_viruses();
;
	.dbg	line, "demo.c", 143
	jsr     _initialise_viruses
;
; while (1) {
;
	.dbg	line, "demo.c", 146
	jmp     L0004
;
; movement();
;
	.dbg	line, "demo.c", 147
L0002:	jsr     _movement
;
; draw_sprites();
;
	.dbg	line, "demo.c", 148
	jsr     _draw_sprites
;
; ppu_wait_nmi();
;
	.dbg	line, "demo.c", 150
	jsr     _ppu_wait_nmi
;
; while (1) {
;
	.dbg	line, "demo.c", 146
L0004:	jmp     L0002
;
; }
;
	.dbg	line, "demo.c", 152
	rts

	.dbg	line
.endproc

