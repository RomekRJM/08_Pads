;
; File generated by cc65 v 2.19 - Git c3d7a90
;
	.fopt		compiler,"cc65 v 2.19 - Git c3d7a90"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	on
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.dbg		file, "demo.c", 7730, 1643436389
	.dbg		file, "lib/neslib.h", 9271, 1642938971
	.dbg		file, "lib/nesdoug.h", 6862, 1642938971
	.dbg		file, "sprites.h", 732, 1643435437
	.dbg		file, "lungs.h", 744, 1643255373
	.dbg		file, "math.h", 406, 1643431546
	.forceimport	__STARTUP__
	.dbg		sym, "pal_bg", "00", extern, "_pal_bg"
	.dbg		sym, "pal_spr", "00", extern, "_pal_spr"
	.dbg		sym, "ppu_wait_nmi", "00", extern, "_ppu_wait_nmi"
	.dbg		sym, "ppu_off", "00", extern, "_ppu_off"
	.dbg		sym, "ppu_on_all", "00", extern, "_ppu_on_all"
	.dbg		sym, "oam_clear", "00", extern, "_oam_clear"
	.dbg		sym, "oam_meta_spr", "00", extern, "_oam_meta_spr"
	.dbg		sym, "bank_spr", "00", extern, "_bank_spr"
	.dbg		sym, "vram_adr", "00", extern, "_vram_adr"
	.dbg		sym, "vram_unrle", "00", extern, "_vram_unrle"
	.dbg		sym, "get_frame_count", "00", extern, "_get_frame_count"
	.dbg		sym, "virusPath", "00", extern, "_virusPath"
	.import		_pal_bg
	.import		_pal_spr
	.import		_ppu_wait_nmi
	.import		_ppu_off
	.import		_ppu_on_all
	.import		_oam_clear
	.import		_oam_meta_spr
	.import		_bank_spr
	.import		_vram_adr
	.import		_vram_unrle
	.import		_get_frame_count
	.export		_virusSprite0
	.export		_virusSprite1
	.export		_virusSprite2
	.export		_virusSprite3
	.export		_virusSpriteLookup
	.export		_lungs
	.import		_virusPath
	.export		_virusCoordinates
	.export		_initialVirusCoordinates
	.export		_virusSprite
	.export		_virusesInRow
	.export		_y
	.export		_x
	.export		_i
	.export		_initial
	.export		_path
	.export		_sprite
	.export		_dbg1
	.export		_dbg2
	.export		_dbg3
	.export		_paletteBackground
	.export		_paletteSprite
	.export		_initialise_viruses
	.export		_movement
	.export		_draw_sprites
	.export		_init_nes
	.export		_main

.segment	"DATA"

_virusSpriteLookup:
	.addr	_virusSprite0
	.addr	_virusSprite1
	.addr	_virusSprite2
	.addr	_virusSprite3
_virusSprite:
	.byte	$00
_virusesInRow:
	.byte	$00
_y:
	.byte	$78
_x:
	.byte	$36
_dbg1:
	.word	$0080
_dbg2:
	.word	$0081
_dbg3:
	.word	$0082

.segment	"RODATA"

_virusSprite0:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$10
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$11
	.byte	$00
	.byte	$80
_virusSprite1:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$10
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$11
	.byte	$00
	.byte	$80
_virusSprite2:
	.byte	$00
	.byte	$00
	.byte	$20
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$21
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$30
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$31
	.byte	$00
	.byte	$80
_virusSprite3:
	.byte	$00
	.byte	$00
	.byte	$40
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$41
	.byte	$00
	.byte	$00
	.byte	$08
	.byte	$50
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$51
	.byte	$00
	.byte	$80
_lungs:
	.byte	$01
	.byte	$00
	.byte	$01
	.byte	$FE
	.byte	$00
	.byte	$01
	.byte	$4C
	.byte	$80
	.byte	$81
	.byte	$82
	.byte	$83
	.byte	$84
	.byte	$85
	.byte	$86
	.byte	$87
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$90
	.byte	$91
	.byte	$92
	.byte	$93
	.byte	$94
	.byte	$95
	.byte	$96
	.byte	$97
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$A0
	.byte	$A1
	.byte	$A2
	.byte	$A3
	.byte	$A4
	.byte	$A5
	.byte	$A6
	.byte	$A7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$B0
	.byte	$B1
	.byte	$B2
	.byte	$B3
	.byte	$B4
	.byte	$B5
	.byte	$B6
	.byte	$B7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$C0
	.byte	$C1
	.byte	$C2
	.byte	$C3
	.byte	$C4
	.byte	$C5
	.byte	$C6
	.byte	$C7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$D0
	.byte	$D1
	.byte	$D2
	.byte	$D3
	.byte	$D4
	.byte	$D5
	.byte	$D6
	.byte	$D7
	.byte	$00
	.byte	$01
	.byte	$17
	.byte	$E0
	.byte	$E1
	.byte	$E2
	.byte	$E3
	.byte	$E4
	.byte	$E5
	.byte	$E6
	.byte	$E7
	.byte	$00
	.byte	$01
	.byte	$FE
	.byte	$00
	.byte	$01
	.byte	$BD
	.byte	$A0
	.byte	$01
	.byte	$03
	.byte	$20
	.byte	$00
	.byte	$01
	.byte	$04
	.byte	$AA
	.byte	$AA
	.byte	$00
	.byte	$01
	.byte	$05
	.byte	$0A
	.byte	$0A
	.byte	$00
	.byte	$01
	.byte	$19
	.byte	$00
	.byte	$01
	.byte	$00
_paletteBackground:
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
	.byte	$0F
	.byte	$06
	.byte	$16
	.byte	$26
_paletteSprite:
	.byte	$0F
	.byte	$3D
	.byte	$05
	.byte	$17
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05
	.byte	$0F
	.byte	$3D
	.byte	$30
	.byte	$05

.segment	"BSS"

.segment	"ZEROPAGE"
_virusCoordinates:
	.res	32,$00
_initialVirusCoordinates:
	.res	32,$00
_i:
	.res	1,$00
_initial:
	.res	1,$00
_path:
	.res	1,$00
_sprite:
	.res	2,$00

; ---------------------------------------------------------------
; void __near__ initialise_viruses (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_initialise_viruses: near

	.dbg	func, "initialise_viruses", "00", extern, "_initialise_viruses"

.segment	"CODE"

;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 42
	lda     #$00
	sta     _i
L000A:	lda     _i
	cmp     #$10
	bcs     L0003
;
; initialVirusCoordinates.x[i] = x;
;
	.dbg	line, "demo.c", 43
	ldy     _i
	lda     _x
	sta     _initialVirusCoordinates,y
;
; initialVirusCoordinates.y[i] = y;
;
	.dbg	line, "demo.c", 44
	ldy     _i
	lda     _y
	sta     _initialVirusCoordinates+16,y
;
; if (virusesInRow < 3) {
;
	.dbg	line, "demo.c", 46
	lda     _virusesInRow
	cmp     #$03
	bcs     L000B
;
; x += 40;
;
	.dbg	line, "demo.c", 47
	lda     #$28
	clc
	adc     _x
	sta     _x
;
; ++virusesInRow;
;
	.dbg	line, "demo.c", 48
	inc     _virusesInRow
;
; } else {
;
	.dbg	line, "demo.c", 49
	jmp     L000C
;
; x = 54;
;
	.dbg	line, "demo.c", 50
L000B:	lda     #$36
	sta     _x
;
; y += 20;
;
	.dbg	line, "demo.c", 51
	lda     #$14
	clc
	adc     _y
	sta     _y
;
; virusesInRow = 0;
;
	.dbg	line, "demo.c", 52
	lda     #$00
	sta     _virusesInRow
;
; for (i = 0; i < NUM_VIRUSES; ++i) {
;
	.dbg	line, "demo.c", 42
L000C:	inc     _i
	jmp     L000A
;
; }
;
	.dbg	line, "demo.c", 55
L0003:	rts

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ movement (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_movement: near

	.dbg	func, "movement", "00", extern, "_movement"

.segment	"CODE"

;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 58
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[0];
;
	.dbg	line, "demo.c", 59
	lda     _initialVirusCoordinates
	sta     _initial
;
; virusCoordinates.x[0] = initial + path;
;
	.dbg	line, "demo.c", 60
	clc
	adc     _path
	sta     _virusCoordinates
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 62
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[0];
;
	.dbg	line, "demo.c", 63
	lda     _initialVirusCoordinates+16
	sta     _initial
;
; virusCoordinates.y[0] = initial + path;
;
	.dbg	line, "demo.c", 64
	clc
	adc     _path
	sta     _virusCoordinates+16
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 66
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[1];
;
	.dbg	line, "demo.c", 67
	lda     _initialVirusCoordinates+1
	sta     _initial
;
; virusCoordinates.x[1] = initial + path;
;
	.dbg	line, "demo.c", 68
	clc
	adc     _path
	sta     _virusCoordinates+1
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 70
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[1];
;
	.dbg	line, "demo.c", 71
	lda     _initialVirusCoordinates+17
	sta     _initial
;
; virusCoordinates.y[1] = initial + path;
;
	.dbg	line, "demo.c", 72
	clc
	adc     _path
	sta     _virusCoordinates+17
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 74
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[2];
;
	.dbg	line, "demo.c", 75
	lda     _initialVirusCoordinates+2
	sta     _initial
;
; virusCoordinates.x[2] = initial + path;
;
	.dbg	line, "demo.c", 76
	clc
	adc     _path
	sta     _virusCoordinates+2
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 78
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[2];
;
	.dbg	line, "demo.c", 79
	lda     _initialVirusCoordinates+18
	sta     _initial
;
; virusCoordinates.y[2] = initial + path;
;
	.dbg	line, "demo.c", 80
	clc
	adc     _path
	sta     _virusCoordinates+18
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 82
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[3];
;
	.dbg	line, "demo.c", 83
	lda     _initialVirusCoordinates+3
	sta     _initial
;
; virusCoordinates.x[3] = initial + path;
;
	.dbg	line, "demo.c", 84
	clc
	adc     _path
	sta     _virusCoordinates+3
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 86
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[3];
;
	.dbg	line, "demo.c", 87
	lda     _initialVirusCoordinates+19
	sta     _initial
;
; virusCoordinates.y[3] = initial + path;
;
	.dbg	line, "demo.c", 88
	clc
	adc     _path
	sta     _virusCoordinates+19
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 90
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[4];
;
	.dbg	line, "demo.c", 91
	lda     _initialVirusCoordinates+4
	sta     _initial
;
; virusCoordinates.x[4] = initial + path;
;
	.dbg	line, "demo.c", 92
	clc
	adc     _path
	sta     _virusCoordinates+4
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 94
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[4];
;
	.dbg	line, "demo.c", 95
	lda     _initialVirusCoordinates+20
	sta     _initial
;
; virusCoordinates.y[4] = initial + path;
;
	.dbg	line, "demo.c", 96
	clc
	adc     _path
	sta     _virusCoordinates+20
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 98
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[5];
;
	.dbg	line, "demo.c", 99
	lda     _initialVirusCoordinates+5
	sta     _initial
;
; virusCoordinates.x[5] = initial + path;
;
	.dbg	line, "demo.c", 100
	clc
	adc     _path
	sta     _virusCoordinates+5
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 102
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[5];
;
	.dbg	line, "demo.c", 103
	lda     _initialVirusCoordinates+21
	sta     _initial
;
; virusCoordinates.y[5] = initial + path;
;
	.dbg	line, "demo.c", 104
	clc
	adc     _path
	sta     _virusCoordinates+21
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 106
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[6];
;
	.dbg	line, "demo.c", 107
	lda     _initialVirusCoordinates+6
	sta     _initial
;
; virusCoordinates.x[6] = initial + path;
;
	.dbg	line, "demo.c", 108
	clc
	adc     _path
	sta     _virusCoordinates+6
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 110
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[6];
;
	.dbg	line, "demo.c", 111
	lda     _initialVirusCoordinates+22
	sta     _initial
;
; virusCoordinates.y[6] = initial + path;
;
	.dbg	line, "demo.c", 112
	clc
	adc     _path
	sta     _virusCoordinates+22
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 114
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[7];
;
	.dbg	line, "demo.c", 115
	lda     _initialVirusCoordinates+7
	sta     _initial
;
; virusCoordinates.x[7] = initial + path;
;
	.dbg	line, "demo.c", 116
	clc
	adc     _path
	sta     _virusCoordinates+7
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 118
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[7];
;
	.dbg	line, "demo.c", 119
	lda     _initialVirusCoordinates+23
	sta     _initial
;
; virusCoordinates.y[7] = initial + path;
;
	.dbg	line, "demo.c", 120
	clc
	adc     _path
	sta     _virusCoordinates+23
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 122
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[8];
;
	.dbg	line, "demo.c", 123
	lda     _initialVirusCoordinates+8
	sta     _initial
;
; virusCoordinates.x[8] = initial + path;
;
	.dbg	line, "demo.c", 124
	clc
	adc     _path
	sta     _virusCoordinates+8
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 126
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[8];
;
	.dbg	line, "demo.c", 127
	lda     _initialVirusCoordinates+24
	sta     _initial
;
; virusCoordinates.y[8] = initial + path;
;
	.dbg	line, "demo.c", 128
	clc
	adc     _path
	sta     _virusCoordinates+24
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 130
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[9];
;
	.dbg	line, "demo.c", 131
	lda     _initialVirusCoordinates+9
	sta     _initial
;
; virusCoordinates.x[9] = initial + path;
;
	.dbg	line, "demo.c", 132
	clc
	adc     _path
	sta     _virusCoordinates+9
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 134
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[9];
;
	.dbg	line, "demo.c", 135
	lda     _initialVirusCoordinates+25
	sta     _initial
;
; virusCoordinates.y[9] = initial + path;
;
	.dbg	line, "demo.c", 136
	clc
	adc     _path
	sta     _virusCoordinates+25
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 138
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[10];
;
	.dbg	line, "demo.c", 139
	lda     _initialVirusCoordinates+10
	sta     _initial
;
; virusCoordinates.x[10] = initial + path;
;
	.dbg	line, "demo.c", 140
	clc
	adc     _path
	sta     _virusCoordinates+10
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 142
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[10];
;
	.dbg	line, "demo.c", 143
	lda     _initialVirusCoordinates+26
	sta     _initial
;
; virusCoordinates.y[10] = initial + path;
;
	.dbg	line, "demo.c", 144
	clc
	adc     _path
	sta     _virusCoordinates+26
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 146
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[11];
;
	.dbg	line, "demo.c", 147
	lda     _initialVirusCoordinates+11
	sta     _initial
;
; virusCoordinates.x[11] = initial + path;
;
	.dbg	line, "demo.c", 148
	clc
	adc     _path
	sta     _virusCoordinates+11
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 150
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[11];
;
	.dbg	line, "demo.c", 151
	lda     _initialVirusCoordinates+27
	sta     _initial
;
; virusCoordinates.y[11] = initial + path;
;
	.dbg	line, "demo.c", 152
	clc
	adc     _path
	sta     _virusCoordinates+27
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 154
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[12];
;
	.dbg	line, "demo.c", 155
	lda     _initialVirusCoordinates+12
	sta     _initial
;
; virusCoordinates.x[12] = initial + path;
;
	.dbg	line, "demo.c", 156
	clc
	adc     _path
	sta     _virusCoordinates+12
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 158
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[12];
;
	.dbg	line, "demo.c", 159
	lda     _initialVirusCoordinates+28
	sta     _initial
;
; virusCoordinates.y[12] = initial + path;
;
	.dbg	line, "demo.c", 160
	clc
	adc     _path
	sta     _virusCoordinates+28
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 162
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[13];
;
	.dbg	line, "demo.c", 163
	lda     _initialVirusCoordinates+13
	sta     _initial
;
; virusCoordinates.x[13] = initial + path;
;
	.dbg	line, "demo.c", 164
	clc
	adc     _path
	sta     _virusCoordinates+13
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 166
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[13];
;
	.dbg	line, "demo.c", 167
	lda     _initialVirusCoordinates+29
	sta     _initial
;
; virusCoordinates.y[13] = initial + path;
;
	.dbg	line, "demo.c", 168
	clc
	adc     _path
	sta     _virusCoordinates+29
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 170
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[14];
;
	.dbg	line, "demo.c", 171
	lda     _initialVirusCoordinates+14
	sta     _initial
;
; virusCoordinates.x[14] = initial + path;
;
	.dbg	line, "demo.c", 172
	clc
	adc     _path
	sta     _virusCoordinates+14
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 174
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[14];
;
	.dbg	line, "demo.c", 175
	lda     _initialVirusCoordinates+30
	sta     _initial
;
; virusCoordinates.y[14] = initial + path;
;
	.dbg	line, "demo.c", 176
	clc
	adc     _path
	sta     _virusCoordinates+30
;
; path = virusPath.x[get_frame_count()];
;
	.dbg	line, "demo.c", 178
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath)
	sta     ptr1+1
	ldy     #<(_virusPath)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.x[15];
;
	.dbg	line, "demo.c", 179
	lda     _initialVirusCoordinates+15
	sta     _initial
;
; virusCoordinates.x[15] = initial + path;
;
	.dbg	line, "demo.c", 180
	clc
	adc     _path
	sta     _virusCoordinates+15
;
; path = virusPath.y[get_frame_count()];
;
	.dbg	line, "demo.c", 182
	jsr     _get_frame_count
	sta     ptr1
	txa
	clc
	adc     #>(_virusPath+256)
	sta     ptr1+1
	ldy     #<(_virusPath+256)
	lda     (ptr1),y
	sta     _path
;
; initial = initialVirusCoordinates.y[15];
;
	.dbg	line, "demo.c", 183
	lda     _initialVirusCoordinates+31
	sta     _initial
;
; virusCoordinates.y[15] = initial + path;
;
	.dbg	line, "demo.c", 184
	clc
	adc     _path
	sta     _virusCoordinates+31
;
; }
;
	.dbg	line, "demo.c", 185
	rts

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ draw_sprites (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_sprites: near

	.dbg	func, "draw_sprites", "00", extern, "_draw_sprites"

.segment	"CODE"

;
; oam_clear();
;
	.dbg	line, "demo.c", 188
	jsr     _oam_clear
;
; if ((get_frame_count() & 7) == 0) {
;
	.dbg	line, "demo.c", 190
	jsr     _get_frame_count
	ldx     #$00
	and     #$07
	bne     L0006
;
; virusSprite = ++virusSprite & 3;
;
	.dbg	line, "demo.c", 191
	inc     _virusSprite
	lda     _virusSprite
	and     #$03
	sta     _virusSprite
;
; sprite = virusSpriteLookup[virusSprite];
;
	.dbg	line, "demo.c", 194
L0006:	lda     _virusSprite
	asl     a
	bcc     L0005
	inx
	clc
L0005:	adc     #<(_virusSpriteLookup)
	sta     ptr1
	txa
	adc     #>(_virusSpriteLookup)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sta     _sprite+1
	dey
	lda     (ptr1),y
	sta     _sprite
;
; oam_meta_spr(virusCoordinates.x[0], virusCoordinates.y[0], sprite);
;
	.dbg	line, "demo.c", 196
	jsr     decsp2
	lda     _virusCoordinates
	iny
	sta     (sp),y
	lda     _virusCoordinates+16
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[1], virusCoordinates.y[1], sprite);
;
	.dbg	line, "demo.c", 197
	jsr     decsp2
	lda     _virusCoordinates+1
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+17
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[2], virusCoordinates.y[2], sprite);
;
	.dbg	line, "demo.c", 198
	jsr     decsp2
	lda     _virusCoordinates+2
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+18
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[3], virusCoordinates.y[3], sprite);
;
	.dbg	line, "demo.c", 199
	jsr     decsp2
	lda     _virusCoordinates+3
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+19
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[4], virusCoordinates.y[4], sprite);
;
	.dbg	line, "demo.c", 200
	jsr     decsp2
	lda     _virusCoordinates+4
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+20
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[5], virusCoordinates.y[5], sprite);
;
	.dbg	line, "demo.c", 201
	jsr     decsp2
	lda     _virusCoordinates+5
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+21
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[6], virusCoordinates.y[6], sprite);
;
	.dbg	line, "demo.c", 202
	jsr     decsp2
	lda     _virusCoordinates+6
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+22
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[7], virusCoordinates.y[7], sprite);
;
	.dbg	line, "demo.c", 203
	jsr     decsp2
	lda     _virusCoordinates+7
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+23
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[8], virusCoordinates.y[8], sprite);
;
	.dbg	line, "demo.c", 204
	jsr     decsp2
	lda     _virusCoordinates+8
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+24
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[9], virusCoordinates.y[9], sprite);
;
	.dbg	line, "demo.c", 205
	jsr     decsp2
	lda     _virusCoordinates+9
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+25
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[10], virusCoordinates.y[10], sprite);
;
	.dbg	line, "demo.c", 206
	jsr     decsp2
	lda     _virusCoordinates+10
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+26
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[11], virusCoordinates.y[11], sprite);
;
	.dbg	line, "demo.c", 207
	jsr     decsp2
	lda     _virusCoordinates+11
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+27
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[12], virusCoordinates.y[12], sprite);
;
	.dbg	line, "demo.c", 208
	jsr     decsp2
	lda     _virusCoordinates+12
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+28
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[13], virusCoordinates.y[13], sprite);
;
	.dbg	line, "demo.c", 209
	jsr     decsp2
	lda     _virusCoordinates+13
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+29
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[14], virusCoordinates.y[14], sprite);
;
	.dbg	line, "demo.c", 210
	jsr     decsp2
	lda     _virusCoordinates+14
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+30
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jsr     _oam_meta_spr
;
; oam_meta_spr(virusCoordinates.x[15], virusCoordinates.y[15], sprite);
;
	.dbg	line, "demo.c", 211
	jsr     decsp2
	lda     _virusCoordinates+15
	ldy     #$01
	sta     (sp),y
	lda     _virusCoordinates+31
	dey
	sta     (sp),y
	lda     _sprite
	ldx     _sprite+1
	jmp     _oam_meta_spr

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ init_nes (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_init_nes: near

	.dbg	func, "init_nes", "00", extern, "_init_nes"

.segment	"CODE"

;
; ppu_off(); // screen off
;
	.dbg	line, "demo.c", 216
	jsr     _ppu_off
;
; pal_bg(paletteBackground);
;
	.dbg	line, "demo.c", 219
	lda     #<(_paletteBackground)
	ldx     #>(_paletteBackground)
	jsr     _pal_bg
;
; pal_spr(paletteSprite);
;
	.dbg	line, "demo.c", 220
	lda     #<(_paletteSprite)
	ldx     #>(_paletteSprite)
	jsr     _pal_spr
;
; bank_spr(1);
;
	.dbg	line, "demo.c", 224
	lda     #$01
	jsr     _bank_spr
;
; vram_adr(NAMETABLE_A);
;
	.dbg	line, "demo.c", 226
	ldx     #$20
	lda     #$00
	jsr     _vram_adr
;
; vram_unrle(lungs);
;
	.dbg	line, "demo.c", 228
	lda     #<(_lungs)
	ldx     #>(_lungs)
	jsr     _vram_unrle
;
; ppu_on_all();
;
	.dbg	line, "demo.c", 231
	jmp     _ppu_on_all

	.dbg	line
.endproc

; ---------------------------------------------------------------
; void __near__ main (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_main: near

	.dbg	func, "main", "00", extern, "_main"

.segment	"CODE"

;
; init_nes();
;
	.dbg	line, "demo.c", 235
	jsr     _init_nes
;
; initialise_viruses();
;
	.dbg	line, "demo.c", 237
	jsr     _initialise_viruses
;
; movement();
;
	.dbg	line, "demo.c", 240
L0002:	jsr     _movement
;
; draw_sprites();
;
	.dbg	line, "demo.c", 241
	jsr     _draw_sprites
;
; ppu_wait_nmi();
;
	.dbg	line, "demo.c", 243
	jsr     _ppu_wait_nmi
;
; while (1) {
;
	.dbg	line, "demo.c", 239
	jmp     L0002

	.dbg	line
.endproc

